# Creating traffic maps  (RMF Traffic Editor)

Inspiration taken from: https://github.com/open-rmf/rmf_demos/tree/humble

1. Have a straightened .png map generated by nav2 and cleaned up in gimp, as detailed in the [slam tutorial](/docs/SLAM.md)
2. Run `docker compose -f docker-compose.rmf_editor.yaml up`, this will open rmf traffic editor with a traffic map loaded.

![image](https://github.com/user-attachments/assets/7d613809-03db-4354-8033-5274706a7671)

3. See documentation for [rmf traffic editor](https://osrf.github.io/ros2multirobotbook/traffic-editor.html).

4. **Important Notes!**
   1. We are not currently using the Gazebo world generation capabilities of rmf traffic editor, so the .building.yaml doesn't need floors/walls added.
   2. Sometimes RMF traffic editor won't let you select a lane or vertex. The best solution is to save the map and restart the container.
   3. If a vertex in the .building.yaml is not connected to a lane, IT WILL NOT BE INCLUDED IN THE NAV GRAPH!!
   4. Sometimes the program that converts a .building.yaml file to a nav graph gets confused and generated a 0.yaml and 1.yaml file, even if there is only floor 0. In this case, make sure all lanes in your .building.yaml file have the same graph_idx.

Nav2 critic scale: https://robotics.stackexchange.com/questions/105749/dwb-planner-in-nav2-does-not-properly-set-scale-for-critics

To get RMF fleet manager to recognize completed task, robot state must have empty path, and mode set to idle or charging


